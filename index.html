<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>Rusty Tools for Astrophotographers</title>
    <link href="https://fonts.cdnfonts.com/css/rustic-2" rel="stylesheet">
    <link href="styles.css" rel="stylesheet"/>
  </head>
  <body>
    <main>
        <h1>
            Rusty Tools for Astrophotographers
        </h1> 
        <h2> 
            Welcome! This is a free web app for aligning, denoising, and 
            projecting astrophotography images all written in Rust. Enjoy!
        </h2>  
    </main>

    <div class="center";>
      <p>
        Drop directory containing images here
      </p>
    </div>
    
    <script>
        const dropzone = document.querySelector('div');

        function traverseFileTree(item, path) {
          path = path || "";
          if (item.isFile) {
          // Get file
          item.file(function(file) {
            console.log("File:", path + file.name);
          });
         }
          else if (item.isDirectory) {
        // Get folder contents
        var dirReader = item.createReader();
        dirReader.readEntries(function(entries) {
          for (var i=0; i<entries.length; i++) {
            traverseFileTree(entries[i], path + item.name + "/");
          }
        });
      }
    }
        dropArea.addEventListener("drop", function(event) {
          event.preventDefault();
           var items = event.dataTransfer.items;
           for (var i=0; i<items.length; i++) {
            var item = items[i].webkitGetAsEntry();
             if (item) {
               traverseFileTree(item);
              }
            }
          }, false);

        dropzone.addEventListener('dragenter', event => {
          event.preventDefault();
          dropzone.classList.add('active');
        });

        dropzone.addEventListener('dragleave', event => {
          event.preventDefault();
          dropzone.classList.remove('active');
        });

        dropzone.addEventListener('dragover', event => {
          event.preventDefault();
        });

        dropzone.addEventListener('drop', event => {
          event.preventDefault();
          dropzone.classList.remove('active')};
      </script>

    <script type="module">
      import init, { greet } from "./pkg/RustyTools_Astro.js";
      init().then(() => {
        greet("Mother Fucker");
      });
    </script>
  </body>
</html>
